

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Additional tips and tricks for designing networks &mdash; Nengo 2.1.0-dev docs</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Nengo 2.1.0-dev docs" href="../index.html"/>
        <link rel="up" title="Networks" href="../networks.html"/>
        <link rel="next" title="The config system" href="config.html"/>
        <link rel="prev" title="Designing networks" href="network_design.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Nengo
          

          
          </a>

          
            
            
              <div class="version">
                2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../user_api.html">Nengo Modelling API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../networks.html">Networks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="network_design.html">Designing networks</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Additional tips and tricks for designing networks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#accept-a-network-argument">1. Accept a network argument</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accept-a-config-argument-for-groups-of-parameters">2. Accept a config argument for groups of parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#longer-example-double-integrator-network">Longer example: double integrator network</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="config.html">The <code class="docutils literal"><span class="pre">config</span></code> system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networks.html#ensemble-array">Ensemble Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networks.html#action-selection">Action Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networks.html#working-memory">Working Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networks.html#product">Product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networks.html#circular-convolution">Circular Convolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networks.html#integrator">Integrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../networks.html#oscillator">Oscillator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html">Release History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history.html">Nengo history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../converting.html">Converting from Nengo 1.4 to Nengo 2.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Nengo</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../user_guide.html">User Guide</a> &raquo;</li>
      
          <li><a href="../networks.html">Networks</a> &raquo;</li>
      
    <li>Additional tips and tricks for designing networks</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/network_design_advanced.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="additional-tips-and-tricks-for-designing-networks">
<h1>Additional tips and tricks for designing networks<a class="headerlink" href="#additional-tips-and-tricks-for-designing-networks" title="Permalink to this headline">Â¶</a></h1>
<p>This tutorial assumes that you have read the <code class="docutils literal"><span class="pre">network_design</span></code>
tutorial, and have designed a network or two. Here, we will give a few
advanced tips and tricks for designing networks that can be reused
flexibly. In particular, these tips will use the <code class="docutils literal"><span class="pre">config</span></code> system, so
we will also assume that you have gone over the <code class="docutils literal"><span class="pre">config</span></code> tutorial.</p>
<p>Briefly, the general principles covered in this tutorial are</p>
<ol class="arabic simple" start="0">
<li>Accept a network argument</li>
<li>Accept a config argument for groups of parameters</li>
</ol>
<p>We will demonstrate these principles using the two examples from the
<code class="docutils literal"><span class="pre">network_design</span></code> tutorial.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">nengo</span>
<span class="o">%</span><span class="n">load_ext</span> <span class="n">nengo</span><span class="o">.</span><span class="n">ipynb</span>
<span class="kn">from</span> <span class="nn">nengo.dists</span> <span class="kn">import</span> <span class="n">Choice</span>
<span class="kn">from</span> <span class="nn">nengo.utils.functions</span> <span class="kn">import</span> <span class="n">piecewise</span>
<span class="kn">from</span> <span class="nn">nengo.utils.ipython</span> <span class="kn">import</span> <span class="n">hide_input</span>
<span class="k">def</span> <span class="nf">test_integrators</span><span class="p">(</span><span class="n">net</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">net</span><span class="p">:</span>
        <span class="n">piecewise_f</span> <span class="o">=</span> <span class="n">piecewise</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
        <span class="n">piecewise_inp</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">piecewise_f</span><span class="p">)</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">piecewise_inp</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">pre_integrator</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
        <span class="n">input_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">piecewise_inp</span><span class="p">)</span>
        <span class="n">pre_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">pre_integrator</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="n">post_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">post_integrator</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">pre_probe</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">post_probe</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">hide_input</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="highlight-none"><div class="highlight"><pre>
<span></span>&lt;IPython.core.display.Javascript object&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>Out[1]:
</pre></div>
</div>
<div class="container">
<a id="1053602830" href="javascript:toggle_input_1053602830()"
  >Show Input</a>

<script type="text/javascript">
var toggle_input_1053602830;
(function() {
    if (typeof jQuery == 'undefined') {
        // no jQuery
        var link_1053602830 = document.getElementById("1053602830");
        var cell = link_1053602830;
        while (cell.className.split(' ')[0] != "cell") {
            cell = cell.parentNode;
        }
        var input_1053602830;
        for (var i = 0; i < cell.children.length; i++) {
            if (cell.children[i].className.split(' ')[0] == "input")
                input_1053602830 = cell.children[i];
        }
        input_1053602830.style.display = "none"; // hide

        toggle_input_1053602830 = function() {
            if (input_1053602830.style.display == "none") {
                input_1053602830.style.display = ""; // show
                link_1053602830.innerHTML = "Hide Input";
            } else {
                input_1053602830.style.display = "none"; // hide
                link_1053602830.innerHTML = "Show Input";
            }
        }

    } else {
        // jQuery
        var link_1053602830 = $("a[id='1053602830']");
        var cell_1053602830 = link_1053602830.parents("div.cell:first");
        var input_1053602830 = cell_1053602830.children("div.input");
        input_1053602830.hide();

        toggle_input_1053602830 = function() {
            if (input_1053602830.is(':hidden')) {
                input_1053602830.slideDown();
                link_1053602830[0].innerHTML = "Hide Input";
            } else {
                input_1053602830.slideUp();
                link_1053602830[0].innerHTML = "Show Input";
            }
        }
    }
}());
</script></div>
</div>
<div class="section" id="accept-a-network-argument">
<h2>1. Accept a network argument<a class="headerlink" href="#accept-a-network-argument" title="Permalink to this headline">Â¶</a></h2>
<p>Typically, a network-creation function will take a set of arguments,
which affect some important parts of the network. When testing the
network, it&#8217;s common to change several parameters to see how they affect
the network. One way to do this is to add more and more arguments to
your function; this quickly gets out of hand. Instead, use the
<code class="docutils literal"><span class="pre">config</span></code> system, which enables us to set network-level defaults for
all Nengo objects.</p>
<p>You can either do this by creating your network in the context of some
other network, or you can modify your function to optionally take in a
network instance, which you will build your objects into.</p>
<p>In the example below, we change both integrators to use <code class="docutils literal"><span class="pre">LIFRate</span></code>
neurons by changing the <code class="docutils literal"><span class="pre">config</span></code> object in the network both
integrators are build within. We also change the <code class="docutils literal"><span class="pre">post_integrator</span></code> to
use a very small radius by passing in a network which has its default
radius modified.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">Integrator</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">net</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">net</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">net</span><span class="p">:</span>
        <span class="n">net</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">size_in</span><span class="o">=</span><span class="n">dimensions</span><span class="p">)</span>
        <span class="n">net</span><span class="o">.</span><span class="n">ensemble</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">)</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span>
                         <span class="n">synapse</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">net</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Two integrators&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">net</span><span class="p">:</span>
    <span class="c1"># Make both integrators use LIFRate neurons</span>
    <span class="n">net</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">]</span><span class="o">.</span><span class="n">neuron_type</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">LIFRate</span><span class="p">()</span>
    <span class="n">net</span><span class="o">.</span><span class="n">pre_integrator</span> <span class="o">=</span> <span class="n">Integrator</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Lower the radius of the post_integrator</span>
    <span class="n">net</span><span class="o">.</span><span class="n">post_integrator</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
    <span class="n">net</span><span class="o">.</span><span class="n">post_integrator</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">]</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Integrator</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">net</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">post_integrator</span><span class="p">)</span>
    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">pre_integrator</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">post_integrator</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
<span class="n">test_integrators</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="../_images/examples_network_design_advanced_3_0.png" src="../_images/examples_network_design_advanced_3_0.png" />
</div>
</div>
</div>
<div class="section" id="accept-a-config-argument-for-groups-of-parameters">
<h2>2. Accept a config argument for groups of parameters<a class="headerlink" href="#accept-a-config-argument-for-groups-of-parameters" title="Permalink to this headline">Â¶</a></h2>
<p>Often, you will not want to use the network-level defaults for all of
your objects. Some objects need certain things overwritten, while others
need other values overwritten. Again, it is possible to deal with this
issue by adding more and more parameters, but this quickly gets out of
hand. Instead, add a small number of arguments that optionally accept a
<code class="docutils literal"><span class="pre">config</span></code> object, which allows for setting multiple parameters at once.</p>
<p>In the coupled integrator network example, we make two connections. We
have to be careful changing the defaults for those connections, as they
are wildly different; one is a recurrent connection from an ensemble to
itself, while the other is a connection from a node to an ensemble. We
will accept a <code class="docutils literal"><span class="pre">config</span></code> object for the recurrent connection to make
this easier.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">Integrator</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">recurrent_config</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">net</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">net</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">recurrent_config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">recurrent_config</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">)</span>
        <span class="n">recurrent_config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">]</span><span class="o">.</span><span class="n">synapse</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Lowpass</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">net</span><span class="p">:</span>
        <span class="n">net</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">size_in</span><span class="o">=</span><span class="n">dimensions</span><span class="p">)</span>
        <span class="n">net</span><span class="o">.</span><span class="n">ensemble</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">recurrent_config</span><span class="p">:</span>
            <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">ensemble</span><span class="p">)</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">,</span> <span class="s1">&#39;synapse&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tau</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span>
                         <span class="n">synapse</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">net</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Two integrators&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">net</span><span class="p">:</span>
    <span class="c1"># Make both integrators use LIFRate neurons</span>
    <span class="n">net</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">]</span><span class="o">.</span><span class="n">neuron_type</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">LIFRate</span><span class="p">()</span>
    <span class="n">net</span><span class="o">.</span><span class="n">pre_integrator</span> <span class="o">=</span> <span class="n">Integrator</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Give the post_integrator a shorter tau (should make integration fail)</span>
    <span class="n">recurrent_config</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">)</span>
    <span class="n">recurrent_config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">]</span><span class="o">.</span><span class="n">synapse</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Lowpass</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">post_integrator</span> <span class="o">=</span> <span class="n">Integrator</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">recurrent_config</span><span class="o">=</span><span class="n">recurrent_config</span><span class="p">)</span>
    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">pre_integrator</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">post_integrator</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
<span class="n">test_integrators</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="../_images/examples_network_design_advanced_5_0.png" src="../_images/examples_network_design_advanced_5_0.png" />
</div>
</div>
</div>
<div class="section" id="longer-example-double-integrator-network">
<h2>Longer example: double integrator network<a class="headerlink" href="#longer-example-double-integrator-network" title="Permalink to this headline">Â¶</a></h2>
<p>Recall in the previous tutorial that we created a model that released a
lever 0.6 to 1.0 seconds after pressing a lever. Let&#8217;s use the above
principles, and the <code class="docutils literal"><span class="pre">config</span></code> system in general, to improve the code
constructing this model.</p>
<div class="nbinput container">
<div class="highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">controlled_integrator</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">recurrent_config</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">net</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">net</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">recurrent_config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">recurrent_config</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">)</span>
        <span class="n">recurrent_config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">]</span><span class="o">.</span><span class="n">synapse</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Lowpass</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">net</span><span class="p">:</span>
        <span class="n">net</span><span class="o">.</span><span class="n">ensemble</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">recurrent_config</span><span class="p">:</span>
            <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">ensemble</span><span class="p">[:</span><span class="n">dimensions</span><span class="p">],</span>
                             <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">net</span>

<span class="k">def</span> <span class="nf">medial_pfc</span><span class="p">(</span><span class="n">coupling_strength</span><span class="p">,</span> <span class="n">n_neurons_per_integrator</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">recurrent_config</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">net</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">net</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">net</span><span class="p">:</span>
        <span class="n">recurrent_config</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">)</span>
        <span class="n">recurrent_config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">]</span><span class="o">.</span><span class="n">synapse</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Lowpass</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
        <span class="n">net</span><span class="o">.</span><span class="n">pre</span> <span class="o">=</span> <span class="n">controlled_integrator</span><span class="p">(</span><span class="n">n_neurons_per_integrator</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">recurrent_config</span><span class="p">)</span>
        <span class="n">net</span><span class="o">.</span><span class="n">post</span> <span class="o">=</span> <span class="n">controlled_integrator</span><span class="p">(</span><span class="n">n_neurons_per_integrator</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">recurrent_config</span><span class="p">)</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">ensemble</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">net</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">ensemble</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">coupling_strength</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">net</span>

<span class="k">def</span> <span class="nf">motor_cortex</span><span class="p">(</span><span class="n">command_threshold</span><span class="p">,</span> <span class="n">n_neurons_per_command</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ens_config</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">net</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">net</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ens_config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ens_config</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">)</span>
        <span class="n">ens_config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">]</span><span class="o">.</span><span class="n">encoders</span> <span class="o">=</span> <span class="n">Choice</span><span class="p">([[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">ens_config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">]</span><span class="o">.</span><span class="n">intercepts</span> <span class="o">=</span> <span class="n">Choice</span><span class="p">([</span><span class="n">command_threshold</span><span class="p">])</span>
    <span class="k">with</span> <span class="n">net</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">ens_config</span><span class="p">:</span>
            <span class="n">net</span><span class="o">.</span><span class="n">press</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">(</span><span class="n">n_neurons_per_command</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">net</span><span class="o">.</span><span class="n">release</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">(</span><span class="n">n_neurons_per_command</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">net</span>

<span class="k">def</span> <span class="nf">double_integrator</span><span class="p">(</span><span class="n">mpfc_coupling_strength</span><span class="p">,</span>
                      <span class="n">command_threshold</span><span class="p">,</span>
                      <span class="n">press_to_pre_gain</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                      <span class="n">press_to_post_control</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span>
                      <span class="n">recurrent_tau</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                      <span class="n">net</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">net</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">net</span><span class="p">:</span>
        <span class="n">net</span><span class="o">.</span><span class="n">mpfc</span> <span class="o">=</span> <span class="n">medial_pfc</span><span class="p">(</span><span class="n">mpfc_coupling_strength</span><span class="p">)</span>
        <span class="n">net</span><span class="o">.</span><span class="n">motor</span> <span class="o">=</span> <span class="n">motor_cortex</span><span class="p">(</span><span class="n">command_threshold</span><span class="p">)</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">press</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">mpfc</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">ensemble</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">recurrent_tau</span> <span class="o">*</span> <span class="n">press_to_pre_gain</span><span class="p">)</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">press</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">mpfc</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">ensemble</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">press_to_post_control</span><span class="p">)</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">mpfc</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">ensemble</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">net</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">release</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">net</span>

<span class="k">def</span> <span class="nf">test_doubleintegrator</span><span class="p">(</span><span class="n">net</span><span class="p">):</span>
    <span class="c1"># Provide input and probe outside of network construction, for more flexibility</span>
    <span class="k">with</span> <span class="n">net</span><span class="p">:</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.2</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span> <span class="n">net</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">press</span><span class="p">)</span>
        <span class="n">pr_press</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">press</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="n">pr_release</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">release</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="n">pr_pre_int</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">mpfc</span><span class="o">.</span><span class="n">pre</span><span class="o">.</span><span class="n">ensemble</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="n">pr_post_int</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">mpfc</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">ensemble</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">1.4</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">pr_press</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Press&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">pr_release</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Release&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">pr_pre_int</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pre Integrator&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">pr_post_int</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Post Integrator&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">coupling_strength</span> <span class="ow">in</span> <span class="p">(</span><span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">):</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Set seed here instead</span>
    <span class="c1"># Try the same network with LIFRate neurons</span>
    <span class="n">net</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">]</span><span class="o">.</span><span class="n">neuron_type</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">LIFRate</span><span class="p">()</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">double_integrator</span><span class="p">(</span><span class="n">mpfc_coupling_strength</span><span class="o">=</span><span class="n">coupling_strength</span><span class="p">,</span>
                            <span class="n">command_threshold</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
                            <span class="n">net</span> <span class="o">=</span> <span class="n">net</span><span class="p">)</span>
    <span class="n">test_doubleintegrator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<img alt="../_images/examples_network_design_advanced_7_0.png" src="../_images/examples_network_design_advanced_7_0.png" />
</div>
</div>
<div class="nboutput container">
<div class="container">
</div>
<div class="container">
<img alt="../_images/examples_network_design_advanced_7_1.png" src="../_images/examples_network_design_advanced_7_1.png" />
</div>
</div>
<div class="nboutput nblast container">
<div class="container">
</div>
<div class="container">
<img alt="../_images/examples_network_design_advanced_7_2.png" src="../_images/examples_network_design_advanced_7_2.png" />
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="config.html" class="btn btn-neutral float-right" title="The config system" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="network_design.html" class="btn btn-neutral" title="Designing networks" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2014, Applied Brain Research.
      Last updated on Apr 06, 2016.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.1.0-dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>